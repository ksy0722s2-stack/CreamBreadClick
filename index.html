<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠˆí¬ë¦¼ë¹µ í´ë¦¬ì»¤ - ë¯¸ìŠ¤í„°ë¦¬ ë£¸</title>
    <style>
        /* --- [ê¸°ë³¸ ì„¤ì •] --- */
        body {
            font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
            background-color: #FFF8E7; 
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            user-select: none;
            overflow: hidden;
        }

        .game-container {
            width: 100%;
            max-width: 400px;
            height: 720px;
            background-color: white;
            border-radius: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            padding: 30px 24px;
            box-sizing: border-box;
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- [ëª¨ë‹¬ 1] ì „ì› ë²„íŠ¼ íŒì—… --- */
        #modal-power {
            display: none;
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 400;
            justify-content: center; align-items: center;
            border-radius: 30px;
        }

        .power-box {
            background-color: white;
            width: 80%;
            max-width: 300px;
            padding: 30px 20px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            gap: 20px;
            text-align: center;
        }

        .power-title {
            font-size: 18px; font-weight: bold; color: #000; margin-bottom: 5px;
            display: flex; justify-content: center; align-items: center; gap: 5px;
        }

        .power-input {
            width: 100%; padding: 12px; border: 1px solid #000; border-radius: 6px;
            box-sizing: border-box; font-size: 14px; text-align: center; outline: none;
        }
        .power-input::placeholder { color: #aaa; }

        .power-btn-group { display: flex; gap: 8px; width: 100%; }

        .btn-p-confirm {
            flex: 1; background-color: #333333; color: white; border: none;
            padding: 12px; border-radius: 6px; font-weight: bold; cursor: pointer; font-size: 14px;
        }

        .btn-p-cancel {
            flex: 1; background-color: #EEEEEE; color: #333; border: none;
            padding: 12px; border-radius: 6px; font-weight: bold; cursor: pointer; font-size: 14px;
        }
        .btn-p-confirm:active, .btn-p-cancel:active { transform: scale(0.96); }


        /* --- [ëª¨ë‹¬ 2] í„°ë¯¸ë„ (í‚¤ ì±„êµ´) --- */
        #modal-terminal {
            display: none;
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 300;
            justify-content: center; align-items: center;
            border-radius: 30px;
        }

        .terminal-window {
            width: 90%; height: 65%;
            background-color: #333; color: #CCC;
            border-radius: 25px; padding: 40px 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; font-weight: bold; gap: 40px; box-sizing: border-box;
        }
        .terminal-text { font-size: 22px; color: #EEE; margin-bottom: 10px; }
        .term-btn-continue {
            background-color: #fff; color: #333; border: none; padding: 15px 40px;
            border-radius: 50px; font-weight: 800; cursor: pointer; font-size: 16px;
            transition: all 0.2s; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .term-btn-continue:hover { background-color: #ddd; }
        .progress-container {
            width: 100%; height: 20px; background-color: #555;
            border-radius: 15px; overflow: hidden; display: none; position: relative;
        }
        .progress-fill { height: 100%; width: 0%; background-color: #2ECC71; border-radius: 15px; transition: width 0.1s linear; }
        .progress-text { font-size: 16px; color: #aaa; margin-top: -20px; display: none; }
        .key-display { display: none; flex-direction: column; gap: 20px; width: 100%; align-items: center; }
        .found-key {
            font-size: 18px; color: #2ECC71; background: #222; padding: 20px;
            border-radius: 12px; width: 95%; word-break: break-all; letter-spacing: 0.5px; line-height: 1.4;
        }
        .btn-use-key {
            background-color: #2ECC71; color: white; border: none; padding: 12px 30px;
            border-radius: 30px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 10px;
        }

        /* --- [í™”ë©´ 1] ì—‘ì„¸ìŠ¤ í‚¤ ì…ë ¥ --- */
        #view-access {
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            background-color: #2C3E50; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 200; border-radius: 30px;
        }

        .access-box {
            background-color: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 40px 30px; border-radius: 20px; width: 80%; text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3); display: flex; flex-direction: column; gap: 15px;
        }

        .access-title { color: white; font-size: 20px; font-weight: bold; margin-bottom: 5px; letter-spacing: 1px; }
        .access-input {
            width: 100%; padding: 12px; border-radius: 12px; border: none;
            box-sizing: border-box; font-size: 14px; text-align: center; letter-spacing: 1px;
            background-color: rgba(255,255,255,0.9);
        }
        .access-input:focus { outline: 3px solid #3498DB; }
        .access-btn {
            width: 100%; padding: 12px; background-color: #3498DB; color: white;
            border: none; border-radius: 12px; font-size: 15px; font-weight: bold;
            cursor: pointer; transition: transform 0.1s;
        }
        .access-btn:active { transform: scale(0.96); }
        .get-key-btn {
            width: 100%; padding: 12px; background-color: #2ECC71; color: white;
            border: none; border-radius: 12px; font-size: 15px; font-weight: bold;
            cursor: pointer; transition: transform 0.1s;
        }
        .get-key-btn:active { transform: scale(0.96); }
        .error-msg { color: #E74C3C; font-size: 13px; height: 15px; font-weight: bold; }

        /* --- [í™”ë©´ 2] ì‹œì‘ í™”ë©´ --- */
        #view-start {
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            height: 100%; background-color: #FFF9E6; position: absolute;
            top: 0; left: 0; width: 100%; height: 100%; z-index: 100; border-radius: 30px;
        }
        .intro-logo { width: 120px; margin-bottom: 20px; }
        .intro-text { color: #D35400; font-size: 16px; font-weight: bold; margin-bottom: 30px; }
        .start-btn {
            background-color: #FFA500; color: white; border: none; padding: 12px 40px;
            border-radius: 30px; font-size: 16px; font-weight: bold; cursor: pointer;
            box-shadow: 0 4px 6px rgba(255, 165, 0, 0.3); transition: transform 0.1s;
        }
        .start-btn:active { transform: scale(0.95); }

        /* --- [í™”ë©´ 3] ê²Œì„ í™”ë©´ --- */
        #view-game { display: none; flex-direction: column; gap: 20px; height: 100%; }
        .header {
            display: flex; align-items: center; justify-content: space-between;
            color: #555; font-weight: bold; font-size: 16px; padding-bottom: 10px;
            border-bottom: 1px solid #f0f0f0; min-height: 40px;
        }
        .header-left { display: flex; align-items: center; }
        .nav-btn {
            background: #999; color: white; width: 32px; height: 32px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; margin-right: 12px;
            font-size: 14px; cursor: pointer; transition: background 0.2s;
        }
        .nav-btn:hover { background: #777; }
        .power-btn-top {
            background: #bbb; color: white; width: 32px; height: 32px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-size: 14px; cursor: pointer;
        }
        
        .score-board { text-align: center; margin-top: 10px; }
        .score { font-size: 72px; font-weight: bold; color: #E67E22; margin: 0; line-height: 1; }
        .stats-text { color: #888; font-size: 13px; margin-top: 8px; font-weight: 500; }
        
        .main-area { text-align: center; display: flex; flex-direction: column; align-items: center; gap: 10px; }
        .bread-img { width: 180px; cursor: pointer; transition: transform 0.05s; margin-bottom: 5px; }
        .bread-img:active { transform: scale(0.95); }
        
        .yeeun-msg-area {
            height: 20px; font-size: 14px; font-weight: bold; color: #8E44AD;
            display: flex; align-items: center; justify-content: center; width: 100%;
        }
        .action-btn {
            background: linear-gradient(to right, #FF8C42, #FF7F50); color: white; border: none;
            padding: 14px 0; width: 100%; border-radius: 50px; font-size: 16px; font-weight: bold;
            cursor: pointer; box-shadow: 0 4px 10px rgba(255, 127, 80, 0.3);
        }
        .action-btn:active { transform: translateY(2px); }
        .message-area { height: 20px; font-size: 14px; font-weight: bold; color: #E74C3C; text-align: center; margin-top: 5px;}

        .upgrade-box {
            border: 2px dashed #FCD34D; border-radius: 20px; padding: 20px; background-color: #fffff8;
            display: flex; flex-direction: column; gap: 12px; margin-top: auto;
        }
        .upgrade-item { display: flex; justify-content: space-between; align-items: center; font-size: 14px; font-weight: bold; color: #444; }
        .cost-badge {
            background-color: #E0E0E0; color: #999; padding: 8px 16px; border-radius: 12px;
            font-size: 12px; cursor: not-allowed; transition: all 0.3s; min-width: 60px; text-align: center;
        }
        .cost-badge.active { background-color: #FF8C42; color: white; cursor: pointer; }

        /* --- [í™”ë©´ 4] í†µê³„ í™”ë©´ --- */
        #view-stats { display: none; flex-direction: column; gap: 20px; height: 100%; }
        .stats-box {
            background-color: #FFF9E6; border: 1px solid #FFE082; border-radius: 20px;
            padding: 24px; display: flex; flex-direction: column; gap: 15px;
        }
        .stats-title { font-size: 18px; font-weight: bold; color: #555; padding-bottom: 10px; border-bottom: 2px solid #FFD54F; margin-bottom: 5px; }
        .stats-row { display: flex; flex-direction: column; gap: 5px; font-size: 15px; color: #333; }
        .stats-value { font-weight: bold; font-size: 16px; }
        .special-stat { color: #8E44AD; font-weight: bold; margin-top: 10px; }
        .yama-stat { color: #FF0000; font-weight: bold; margin-top: 5px; }
        .full-yama-stat { color: #8B0000; font-weight: bold; margin-top: 5px; }

        .btn-hidden-page {
            width: 100%; padding: 14px; background-color: #9B59B6; color: white;
            border: none; border-radius: 15px; font-size: 15px; font-weight: bold;
            cursor: pointer; margin-top: 20px; transition: transform 0.1s;
        }
        .btn-hidden-page:active { transform: scale(0.96); }

        /* --- [NEW] í™”ë©´ 5: ìˆ¨ê²¨ì§„ í˜ì´ì§€ (ë§ˆìˆ ì‚¬ì˜ ë°©) --- */
        #view-hidden { 
            display: none; 
            flex-direction: column; 
            justify-content: space-between; /* ìƒë‹¨ í—¤ë”, ì¤‘ë‹¨ ë§ˆìˆ ì‚¬, í•˜ë‹¨ ë²„íŠ¼ ë¶„ë°° */
            height: 100%; 
            /* ì€ì€í•œ ë³´ë¼ìƒ‰ ì¡°ëª…ì´ ë“¤ì–´ì˜¤ëŠ” ì–´ë‘ìš´ ê³µê°„ ë°°ê²½ */
            background: radial-gradient(circle at center, #4a148c 0%, #1a0033 60%, #000000 100%);
            border-radius: 30px;
            padding: 30px 24px;
            box-sizing: border-box;
            color: white;
            position: relative;
        }
        
        /* ì–´ë‘ìš´ í…Œë§ˆìš© í—¤ë” */
        #view-hidden .header {
            border-bottom: 1px solid rgba(255,255,255,0.2);
            color: #D1C4E9;
        }
        #view-hidden .nav-btn {
            background: rgba(255,255,255,0.2);
            color: #fff;
        }

        /* ë§ˆìˆ ì‚¬ ì˜ì—­ */
        .magician-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .magician-img {
            width: 220px;
            /* ì‹ ë¹„ë¡œìš´ ë³´ë¼ìƒ‰ ê·¸ë¦¼ì íš¨ê³¼ */
            filter: drop-shadow(0 0 20px rgba(155, 89, 182, 0.6));
            animation: floatMagician 3s ease-in-out infinite;
        }
        .magician-msg {
            margin-top: 20px;
            font-size: 16px;
            color: #E1BEE7;
            text-align: center;
            font-style: italic;
            min-height: 24px;
        }

        /* í•˜ë‹¨ ë¯¸ìŠ¤í„°ë¦¬ ë²„íŠ¼ */
        .mystery-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #8E44AD, #673AB7);
            color: white;
            border: 1px solid #9B59B6;
            border-radius: 15px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.5);
            transition: all 0.2s;
            margin-bottom: 10px;
        }
        .mystery-btn:active {
            transform: scale(0.95);
            box-shadow: 0 0 5px rgba(138, 43, 226, 0.8);
        }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes slideInRight { from { opacity: 0; transform: translateX(50px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes slideInLeft { from { opacity: 0; transform: translateX(-50px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes slideUpFade { to { opacity: 0; transform: translateY(-50px); visibility: hidden; } }
        @keyframes fadeOut { to { opacity: 0; visibility: hidden; } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        @keyframes blinkPurple { 0% { opacity: 0; } 20% { opacity: 1; } 80% { opacity: 1; } 100% { opacity: 0; } }
        /* ë§ˆìˆ ì‚¬ ë‘¥ë‘¥ ë– ë‹¤ë‹ˆëŠ” íš¨ê³¼ */
        @keyframes floatMagician { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

    </style>
</head>
<body>

    <div class="game-container">
        
        <div id="modal-power">
            <div class="power-box">
                <div class="power-title">ğŸ”’ ë³´ì•ˆ ì½”ë“œ ì¸ì¦</div>
                <input type="password" class="power-input" id="power-input-code" placeholder="ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                <div class="power-btn-group">
                    <button class="btn-p-confirm" id="btn-power-confirm">í™•ì¸</button>
                    <button class="btn-p-cancel" id="btn-power-cancel">ì·¨ì†Œ</button>
                </div>
            </div>
        </div>

        <div id="modal-terminal">
            <div class="terminal-window">
                <div class="terminal-text" id="term-msg">í‚¤ë¥¼ ì±„êµ´ í•˜ê² ìŠµë‹ˆê¹Œ?</div>
                <button class="term-btn-continue" id="btn-term-continue">Continue</button>
                <div class="progress-container" id="progress-container">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-text" id="progress-text">0%</div>
                <div class="key-display" id="key-display-area">
                    <div>ACCESS KEY:</div>
                    <div class="found-key" id="found-key-text"></div>
                    <button class="btn-use-key" id="btn-use-key">ì…ë ¥í•˜ê³  ë‹«ê¸°</button>
                </div>
            </div>
        </div>

        <div id="view-access">
            <div class="access-box">
                <div class="access-title">ACCESS KEY</div>
                <input type="password" class="access-input" id="input-access-key" placeholder="í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                <button class="access-btn" id="btn-submit-key">ì ‘ì† ìŠ¹ì¸</button>
                <button class="get-key-btn" id="btn-open-terminal">í‚¤ ì–»ê¸°</button>
                <div class="error-msg" id="access-error-msg"></div>
            </div>
        </div>

        <div id="view-start">
            <img src="https://cdn-icons-png.flaticon.com/512/3081/3081840.png" alt="ë¡œê³ " class="intro-logo">
            <div class="intro-text">ì¥ì¸ì˜ ê¸¸ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤.</div>
            <button class="start-btn" id="btn-start">ê²Œì„ ì‹œì‘</button>
        </div>

        <div id="view-game">
            <div class="header">
                <div class="header-left">
                    <div class="nav-btn" id="btn-go-stats">&gt;</div>
                    <span>1 ìŠˆí¬ë¦¼ë¹µ: ì¥ì¸ ğŸ¥</span>
                </div>
                <div class="power-btn-top" id="btn-power-game">â»</div>
            </div>
            <div class="score-board">
                <div class="score" id="score">0</div>
                <div class="stats-text" id="stats-text">ìˆ™ë ¨ë„: 1.0 / ìë™: 0/ì´ˆ</div>
            </div>
            <div class="main-area">
                <img src="https://cdn-icons-png.flaticon.com/512/3081/3081840.png" alt="ë¹µ ë°”êµ¬ë‹ˆ" class="bread-img" id="click-target">
                <div class="yeeun-msg-area" id="yeeun-msg-area"></div>
                <button class="action-btn" id="feed-btn">ğŸ˜‹ ìŠ¹ë¯¼ì´í•œí…Œ 1ê°œì”© ë¨¹ì´ê¸°</button>
                <div class="message-area" id="msg-box"></div>
            </div>
            <div class="upgrade-box">
                <div class="upgrade-item"><span>ì†ë†€ë¦¼ ê°•í™” (+0.5)</span><div class="cost-badge" id="btn-upgrade-1">3 ğŸ¥</div></div>
                <div class="upgrade-item"><span>ì œë¹µê¸° ì„¤ì¹˜ (+2/ì´ˆ)</span><div class="cost-badge" id="btn-upgrade-2">20 ğŸ¥</div></div>
                <div class="upgrade-item"><span id="upgrade-3-title">ë¨¹ì´ê¸° ê°•í™” (+1)</span><div class="cost-badge" id="btn-upgrade-3">50 ğŸ¥</div></div>
            </div>
        </div>

        <div id="view-stats">
            <div class="header">
                <div class="header-left"><div class="nav-btn" id="btn-go-game">&lt;</div><span>2 ë°ì´í„° í†µê³„ ğŸ“Š</span></div>
                <div class="power-btn-top" id="btn-power-stats">â»</div>
            </div>
            <div class="stats-box">
                <div class="stats-title">ğŸ“Š ì‹¤ì‹œê°„ í†µê³„</div>
                <div class="stats-row"><span class="stats-label">ì´ í´ë¦­ íšŸìˆ˜:</span><span class="stats-value"><span id="stat-total-clicks">0</span>íšŒ</span></div>
                <div class="stats-row"><span class="stats-label">ìŠ¹ë¯¼ì´ê°€ ë¨¹ì€ ë¹µ:</span><span class="stats-value"><span id="stat-total-fed">0</span>ê°œ</span></div>
                <div class="stats-row special-stat"><span>ì˜ˆì€ì´ê°€ ì–´ì´ì—†ê²Œ ë³¸ íšŸìˆ˜: <span id="stat-yeeun">0</span>íšŒ</span></div>
                <div class="stats-row yama-stat"><span>ì˜ˆì€ì´ê°€ ì•¼ë§ˆ ëˆ íšŸìˆ˜: <span id="stat-yama">0</span>íšŒ</span></div>
                <div class="stats-row full-yama-stat"><span>ì˜ˆì€ì´ê°€ í’€ì•¼ë§ˆ ëˆ íšŸìˆ˜: <span id="stat-full-yama">0</span>íšŒ</span></div>
                
                <button class="btn-hidden-page" id="btn-go-hidden">ğŸ’œ ìˆ¨ê²¨ì§„ í˜ì´ì§€ë¡œ ì´ë™</button>
            </div>
        </div>

        <div id="view-hidden">
            <div class="header">
                <div class="header-left"><div class="nav-btn" id="btn-back-hidden">&lt;</div><span>The Void</span></div>
            </div>
            <div class="magician-area">
                <img src="https://cdn-icons-png.flaticon.com/512/3081/3081307.png" alt="ë§ˆìˆ ì‚¬" class="magician-img">
                <div class="magician-msg" id="magician-text">"ì›í•˜ëŠ” ê²Œ ë¬´ì—‡ì¸ê°€?"</div>
            </div>
            <button class="mystery-btn" id="btn-mystery">ğŸ”® ìš´ëª…ì˜ ì¹´ë“œ ë½‘ê¸°</button>
        </div>

    </div>

    <script>
        // --- 1. í‚¤ ë° ì½”ë“œ ì„¤ì • ---
        const ACCESS_KEY_ENTRY = "B7x9-Kq2P-vR5m-Zt4W"; 
        const CHEAT_YEON = "SeungMinLoveYeon";        
        const CHEAT_BREAD = "SeungMinLoveCreamBread"; 

        const viewAccess = document.getElementById('view-access');
        const inputKey = document.getElementById('input-access-key');
        const btnSubmitKey = document.getElementById('btn-submit-key');
        const errorMsg = document.getElementById('access-error-msg');

        // í„°ë¯¸ë„ ê´€ë ¨
        const btnOpenTerminal = document.getElementById('btn-open-terminal');
        const modalTerminal = document.getElementById('modal-terminal');
        const termMsg = document.getElementById('term-msg');
        const btnTermContinue = document.getElementById('btn-term-continue');
        const progressContainer = document.getElementById('progress-container');
        const progressFill = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');
        const keyDisplayArea = document.getElementById('key-display-area');
        const foundKeyText = document.getElementById('found-key-text');
        const btnUseKey = document.getElementById('btn-use-key');

        // ì „ì› ë²„íŠ¼ íŒì—… ê´€ë ¨
        const modalPower = document.getElementById('modal-power');
        const btnPowerGame = document.getElementById('btn-power-game');
        const btnPowerStats = document.getElementById('btn-power-stats');
        const btnPowerConfirm = document.getElementById('btn-power-confirm');
        const btnPowerCancel = document.getElementById('btn-power-cancel');
        const powerInput = document.getElementById('power-input-code');

        let usedCheats = { yeon: false, bread: false };

        function openPowerModal() {
            modalPower.style.display = 'flex';
            powerInput.value = ''; 
            powerInput.focus();
        }
        btnPowerGame.addEventListener('click', openPowerModal);
        btnPowerStats.addEventListener('click', openPowerModal);

        btnPowerCancel.addEventListener('click', () => {
            modalPower.style.display = 'none';
        });

        // í™•ì¸ ë²„íŠ¼ ë¡œì§
        btnPowerConfirm.addEventListener('click', () => {
            const inputVal = powerInput.value;

            if (inputVal === CHEAT_YEON) {
                if (usedCheats.yeon) {
                    alert("ì´ ì½”ë“œëŠ” ì´ë¯¸ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.");
                    powerInput.value = "";
                } else {
                    // ì•¼ë§ˆ ë³´ë„ˆìŠ¤ ê³„ì‚°
                    let oldYama = Math.floor(gameState.yeeunCount / 100);
                    let oldFullYama = Math.floor(oldYama / 10);

                    gameState.yeeunCount += 1000;
                    usedCheats.yeon = true; 
                    
                    let newYama = Math.floor(gameState.yeeunCount / 100);
                    let newFullYama = Math.floor(newYama / 10);
                    
                    let bonusMastery = ((newYama - oldYama) * 5) + ((newFullYama - oldFullYama) * 10);
                    gameState.clickPower += bonusMastery;

                    updateDisplay();
                    modalPower.style.display = 'none';
                    msgBox.innerText = `ì¹˜íŠ¸ ë°œë™! ìˆ™ë ¨ë„ +${bonusMastery}`;
                    msgBox.style.color = "#8E44AD";
                    setTimeout(() => { msgBox.innerText = ""; }, 2000);
                }
            } 
            else if (inputVal === CHEAT_BREAD) {
                if (usedCheats.bread) {
                    alert("ì´ ì½”ë“œëŠ” ì´ë¯¸ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.");
                    powerInput.value = "";
                } else {
                    gameState.score += 10000;
                    usedCheats.bread = true; 
                    updateDisplay();
                    modalPower.style.display = 'none';
                    msgBox.innerText = "ì¹˜íŠ¸í‚¤ ì ìš©: ìŠˆí¬ë¦¼ë¹µ ëŒ€ëŸ‰ ìƒì‚°!";
                    msgBox.style.color = "#E67E22";
                    setTimeout(() => { msgBox.innerText = ""; }, 2000);
                }
            } 
            else {
                const box = modalPower.querySelector('.power-box');
                box.style.animation = "shake 0.3s";
                setTimeout(() => { box.style.animation = "none"; }, 300);
                powerInput.value = "";
                powerInput.placeholder = "ì½”ë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤";
            }
        });

        // --- í„°ë¯¸ë„ ë¡œì§ ---
        btnOpenTerminal.addEventListener('click', () => { modalTerminal.style.display = 'flex'; resetTerminal(); });
        btnTermContinue.addEventListener('click', () => {
            btnTermContinue.style.display = 'none'; termMsg.innerText = "ì±„êµ´ ì§„í–‰ ì¤‘...";
            progressContainer.style.display = 'block'; progressText.style.display = 'block'; runMiningAnimation();
        });
        btnUseKey.addEventListener('click', () => { modalTerminal.style.display = 'none'; inputKey.value = ACCESS_KEY_ENTRY; });
        function resetTerminal() {
            termMsg.innerText = "í‚¤ë¥¼ ì±„êµ´ í•˜ê² ìŠµë‹ˆê¹Œ?"; btnTermContinue.style.display = 'block';
            progressContainer.style.display = 'none'; progressText.style.display = 'none'; progressFill.style.width = '0%'; keyDisplayArea.style.display = 'none';
        }
        
        function runMiningAnimation() {
            let width = 0;
            let isStalled = false; 

            const interval = setInterval(() => {
                if (isStalled) return; 

                width += Math.random() * 5; 

                if (width >= 99) {
                    width = 99;
                    isStalled = true; 
                    
                    progressFill.style.width = width + '%';
                    progressText.innerText = Math.floor(width) + '%';

                    setTimeout(() => {
                        width = 100;
                        progressFill.style.width = width + '%';
                        progressText.innerText = Math.floor(width) + '%';
                        clearInterval(interval);
                        showResult();
                    }, 5000);
                } else {
                    progressFill.style.width = width + '%';
                    progressText.innerText = Math.floor(width) + '%';
                }
            }, 100);
        }

        function showResult() { 
            termMsg.innerText = "ì±„êµ´ ì™„ë£Œ!"; 
            progressContainer.style.display = 'none'; 
            progressText.style.display = 'none'; 
            keyDisplayArea.style.display = 'flex'; 
            foundKeyText.innerText = ACCESS_KEY_ENTRY; 
        }

        // --- ì ‘ì† ë¡œì§ ---
        function checkAccessKey() {
            if (inputKey.value === ACCESS_KEY_ENTRY) {
                viewAccess.style.animation = "fadeOut 0.5s forwards"; setTimeout(() => { viewAccess.style.display = 'none'; }, 500);
            } else {
                errorMsg.innerText = "ì ‘ì† ìŠ¹ì¸ ê±°ë¶€ë¨"; viewAccess.querySelector('.access-box').style.animation = "shake 0.3s"; setTimeout(() => { viewAccess.querySelector('.access-box').style.animation = "none"; }, 300); inputKey.value = ""; inputKey.focus();
            }
        }
        btnSubmitKey.addEventListener('click', checkAccessKey);
        inputKey.addEventListener('keyup', (e) => { if (e.key === 'Enter') checkAccessKey(); });

        // --- ê²Œì„ ë¡œì§ ---
        let gameState = { score: 0, clickPower: 1.0, autoPower: 0, feedPower: 1, totalClicks: 0, totalFed: 0, yeeunCount: 0, fedSinceLastYeeun: 0, nextYeeunTarget: 0 };
        let costs = { up1: 3, up2: 20, up3: 50 };
        
        function setNextYeeunTarget() { gameState.nextYeeunTarget = Math.floor(Math.random() * 11) + 10; }
        setNextYeeunTarget();

        const viewStart = document.getElementById('view-start');
        const viewGame = document.getElementById('view-game');
        const viewStats = document.getElementById('view-stats');
        const viewHidden = document.getElementById('view-hidden');

        const btnStart = document.getElementById('btn-start');
        const btnGoStats = document.getElementById('btn-go-stats');
        const btnGoGame = document.getElementById('btn-go-game');
        const btnGoHidden = document.getElementById('btn-go-hidden');
        const btnBackHidden = document.getElementById('btn-back-hidden');
        const btnMystery = document.getElementById('btn-mystery'); // [NEW]

        const scoreEl = document.getElementById('score');
        const statsEl = document.getElementById('stats-text');
        const breadImg = document.getElementById('click-target');
        const feedBtn = document.getElementById('feed-btn');
        const msgBox = document.getElementById('msg-box');
        const yeeunMsgArea = document.getElementById('yeeun-msg-area');
        const btnUp1 = document.getElementById('btn-upgrade-1');
        const btnUp2 = document.getElementById('btn-upgrade-2');
        const btnUp3 = document.getElementById('btn-upgrade-3');
        const titleUp3 = document.getElementById('upgrade-3-title');
        
        const statClicksEl = document.getElementById('stat-total-clicks');
        const statFedEl = document.getElementById('stat-total-fed');
        const statYeeunEl = document.getElementById('stat-yeeun');
        const statYamaEl = document.getElementById('stat-yama');
        const statFullYamaEl = document.getElementById('stat-full-yama');
        const magicianText = document.getElementById('magician-text'); // [NEW]

        function updateDisplay() {
            scoreEl.innerText = Math.floor(gameState.score);
            statsEl.innerText = `ìˆ™ë ¨ë„: ${gameState.clickPower.toFixed(1)} / ìë™: ${gameState.autoPower}/ì´ˆ`;
            feedBtn.innerText = `ğŸ˜‹ ìŠ¹ë¯¼ì´í•œí…Œ ${gameState.feedPower}ê°œì”© ë¨¹ì´ê¸°`;
            updateUpgradeBtn(btnUp1, costs.up1); updateUpgradeBtn(btnUp2, costs.up2); updateUpgradeBtn(btnUp3, costs.up3);
            titleUp3.innerText = `ë¨¹ì´ê¸° ê°•í™” (+1)`;
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            statClicksEl.innerText = gameState.totalClicks; 
            statFedEl.innerText = gameState.totalFed; 
            statYeeunEl.innerText = gameState.yeeunCount;

            let yamaCount = Math.floor(gameState.yeeunCount / 100);
            statYamaEl.innerText = yamaCount;
            let fullYamaCount = Math.floor(yamaCount / 10);
            statFullYamaEl.innerText = fullYamaCount;
        }

        function updateUpgradeBtn(btnElement, cost) {
            btnElement.innerText = `${Math.floor(cost)} ğŸ¥`;
            if (gameState.score >= cost) btnElement.classList.add('active'); else btnElement.classList.remove('active');
        }

        btnStart.addEventListener('click', () => { viewStart.style.animation = 'slideUpFade 0.5s forwards'; viewGame.style.display = 'flex'; viewGame.style.animation = 'slideInRight 0.5s'; });
        btnGoStats.addEventListener('click', () => { viewGame.style.display = 'none'; viewStats.style.display = 'flex'; viewStats.style.animation = 'slideInRight 0.3s'; updateDisplay(); });
        btnGoGame.addEventListener('click', () => { viewStats.style.display = 'none'; viewGame.style.display = 'flex'; viewGame.style.animation = 'slideInLeft 0.3s'; });

        btnGoHidden.addEventListener('click', () => {
            viewStats.style.display = 'none';
            viewHidden.style.display = 'flex';
            viewHidden.style.animation = 'slideInRight 0.3s';
        });
        btnBackHidden.addEventListener('click', () => {
            viewHidden.style.display = 'none';
            viewStats.style.display = 'flex';
            viewStats.style.animation = 'slideInLeft 0.3s';
            magicianText.innerText = "\"ì›í•˜ëŠ” ê²Œ ë¬´ì—‡ì¸ê°€?\""; // ì´ˆê¸°í™”
        });

        // [NEW] ë¯¸ìŠ¤í„°ë¦¬ ë²„íŠ¼ ë¡œì§
        const fortunes = [
            "\"ìŠ¹ë¯¼ì´ëŠ” ë°°ê³ í”„ë‹¤... ì˜ì›íˆ.\"",
            "\"ì˜ˆì€ì´ì˜ ì¸ë‚´ì‹¬ì€ í•œê³„ê°€ ì—†ë‹¤... ì•„ì§ì€.\"",
            "\"ìŠˆí¬ë¦¼ë¹µì€ ì§„ë¦¬ì´ì ë¹›ì´ë‹¤.\"",
            "\"ë” ë§ì€ ë¹µì„ ë°”ì³ë¼!\"",
            "\"ì–´ë‘  ì†ì—ì„œë„ ë¹µ ëƒ„ìƒˆê°€ ë‚œë‹¤.\""
        ];
        btnMystery.addEventListener('click', () => {
            const randomMsg = fortunes[Math.floor(Math.random() * fortunes.length)];
            magicianText.innerText = randomMsg;
            magicianText.style.color = "#FFF";
            setTimeout(() => { magicianText.style.color = "#E1BEE7"; }, 500);
        });

        setInterval(() => { if (gameState.autoPower > 0) { gameState.score += gameState.autoPower; updateDisplay(); } }, 1000);
        breadImg.addEventListener('click', () => { gameState.score += gameState.clickPower; gameState.totalClicks += 1; updateDisplay(); });
        
        feedBtn.addEventListener('click', () => {
            if (gameState.score >= gameState.feedPower) {
                gameState.score -= gameState.feedPower; 
                gameState.totalFed += gameState.feedPower; 
                gameState.fedSinceLastYeeun += gameState.feedPower;
                
                if (gameState.fedSinceLastYeeun >= gameState.nextYeeunTarget) {
                    gameState.yeeunCount += 1; 
                    gameState.fedSinceLastYeeun = 0; 
                    setNextYeeunTarget();
                    
                    if (gameState.yeeunCount % 100 === 0) {
                         gameState.clickPower += 5; 
                         msgBox.innerText = "ì•¼ë§ˆ ë³´ë„ˆìŠ¤! ìˆ™ë ¨ë„ +5";
                         msgBox.style.color = "red";
                    }
                    if (gameState.yeeunCount % 1000 === 0) {
                         gameState.clickPower += 10; 
                         msgBox.innerText = "í’€ì•¼ë§ˆ ë³´ë„ˆìŠ¤! ìˆ™ë ¨ë„ +10";
                         msgBox.style.color = "darkred";
                    }

                    yeeunMsgArea.innerText = "ì˜ˆì€ì´ê°€ ì–´ì´ì—†ê²Œ ì³ë‹¤ë´…ë‹ˆë‹¤. (-_-)"; 
                    yeeunMsgArea.style.animation = "blinkPurple 2s forwards";
                    setTimeout(() => { yeeunMsgArea.innerText = ""; yeeunMsgArea.style.animation = "none"; }, 2000);
                } else { 
                    if(!msgBox.innerText.includes("ë³´ë„ˆìŠ¤")) {
                        msgBox.innerText = `ìŠ¹ë¯¼ì´ê°€ ë¹µ ${gameState.feedPower}ê°œë¥¼ ê¿€êº½!`; 
                        msgBox.style.color = "#E74C3C"; 
                    }
                }
                updateDisplay(); 
                setTimeout(() => { if(msgBox.innerText.includes("ê¿€êº½") || msgBox.innerText.includes("ë³´ë„ˆìŠ¤")) msgBox.innerText = ""; }, 1500);
            } else { 
                msgBox.innerText = `ë¹µì´ ë¶€ì¡±í•´ìš”!`; 
                setTimeout(() => { msgBox.innerText = ""; }, 1000); 
            }
        });

        btnUp1.addEventListener('click', () => { if (gameState.score >= costs.up1) { gameState.score -= costs.up1; gameState.clickPower += 0.5; costs.up1 *= 1.2; updateDisplay(); msgBox.innerText = "ì†ë†€ë¦¼ ê°•í™” ì„±ê³µ!"; msgBox.style.color = "#2ECC71"; setTimeout(() => { msgBox.innerText = ""; }, 1000); } });
        btnUp2.addEventListener('click', () => { if (gameState.score >= costs.up2) { gameState.score -= costs.up2; gameState.autoPower += 2; costs.up2 *= 1.2; updateDisplay(); msgBox.innerText = "ì œë¹µê¸° ì„¤ì¹˜ ì™„ë£Œ!"; msgBox.style.color = "#3498DB"; setTimeout(() => { msgBox.innerText = ""; }, 1000); } });
        btnUp3.addEventListener('click', () => { if (gameState.score >= costs.up3) { gameState.score -= costs.up3; gameState.feedPower += 1; costs.up3 *= 1.2; updateDisplay(); msgBox.innerText = "ë¨¹ì´ê¸° ëŠ¥ë ¥ ê°•í™”!"; msgBox.style.color = "#9B59B6"; setTimeout(() => { msgBox.innerText = ""; }, 1000); } });
        updateDisplay();
    </script>
</body>
</html>
